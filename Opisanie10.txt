0) Создаю клон kali linux в virtualbox и меняю настройки сетевого адаптера с nat на сетевой мост и на клоне, и на основной машине
1) Смотрим на статус портов
2) на клоне ставим слушать порт 4444
3) с другой машины устанавливаем соединение через порт 4444. Отправляем сообщение, оно успешно приходит на первую машину
4-9) настраиваем файрвол только на подключение через порты 22, 80, 443
10) снова ставим машину клон слушать порт 4444
11) с другой машины пробуем установить соединение и отправить сообщение, всё безуспешно
12) сохраняем правила 4-9 в скрипт
13) Добавляем данные строчки:auto eth0
iface eth0 inet dhcp
pre-up iptables-restore < /usr/local/etc/myconfig.fw
в etc/network/intefaces
14) устанавливаем logcheck
15-16) Загружаем список паролей и проводим брутфорс атаку на локальную службу ssh
17) Смотрим отчёт, служба logcheck сообщила об атаке и множественных попытках получить доступ
18-19) Запланируем задание cron для ежечасного запуска logcheck таким образом, чтобы он, после анализа файлов журналов, создавал лог-файл в /data/$(date-time).log
20-22) Делаем скрипт исполняемым
23-25) Добавляем скрипт в etc/cron.hourly
26) Устанавливаем tripwire
27) Добавляем следующий блок в файл twpol.txt: # Webserver file and folder monitoring
(
  rulename = "Web server file and directories",
  severity = $(SIG_HI)
)
{
        /var/www/html   -> $(SEC_BIN);
}
28-29) делаем так, чтобы tripwire реагировал на изменения файлов в директории /var/www/html
30) Запускаем проверку, получаем на выходе 27 сообщений об ошибке, что у нас отсутствуют некоторые директории и файлы
31) Все отсутствующие файлы и директории ставим как комментарий в файле twpol.txt
32) Обновляем службу
33) Запускаем проверку, ошибок больше нет
